import{d as I,u as k,g as R,j as w,c as u,b as e,H as g,q as l,F as C,r as F,s as j,t as i,p as x,e as J,o as _,_ as N}from"../main.js";const p=r=>(x("data-v-2af0a718"),r=r(),J(),r),B={class:"message-fields-wrapper"},A={class:"signed-message-desc"},M=p(()=>e("p",{class:"signed-message-desc_p"},[g(" Event should be signed with your private key in advance. Event will be broadcasted to a selected relay. More details about events and signatures are "),e("a",{target:"_blank",href:"https://github.com/nostr-protocol/nips/blob/master/01.md#events-and-signatures"},"here"),g(". ")],-1)),O={class:"signed-message-desc_p"},P=p(()=>e("br",null,null,-1)),V={key:0,class:"additional-relays"},T={class:"additional-relay-field"},q=p(()=>e("span",null,"1.",-1)),D=["value"],H={class:"additional-relay-field"},L=["onInput"],U={class:"message-fields__field_sig"},Y=p(()=>e("label",{class:"message-fields__label",for:"signed_json"},[e("strong",null,"JSON of a signed event")],-1)),$={class:"field-elements"},z={class:"signed-json-btn-wrapper"},G={class:"error"},K=I({__name:"SignedEventInput",props:{isSendingMessage:{type:Boolean},broadcastError:{}},emits:["broadcastEvent"],setup(r,{emit:v}){const b=v,a=k(),c=R(),d=w(""),y=()=>{if(!c.signedJson.length){d.value="Provide signed event.";return}let s;try{s=JSON.parse(c.signedJson)}catch{d.value="Invalid JSON. Please check it and try again.";return}const t=a.currentRelay;if(!t||t.status!==1){d.value="Please connect to relay first.";return}d.value="",b("broadcastEvent",s,"json")},h=()=>{const s=a.additionalRelaysCountForSignedEvent+1;a.updateAdditionalRelaysCountForSignedEvent(s)},m=s=>{var t;c.updateSignedJson((t=s==null?void 0:s.target)==null?void 0:t.value)},S=(s,t)=>{var o;const n=(o=s==null?void 0:s.target)==null?void 0:o.value;n&&a.updateRelayAdditionalRelaysUrlsForSignedEvent(t,n)};return(s,t)=>{var n,o;return _(),u("div",B,[e("div",A,[M,e("p",O,[g(" Event will be broadcasted to a selected relay. You can add more relays to retransmit the event. "),P,e("button",{class:"additional-relay-btn",onClick:h}," Add relay "),l(a).additionalRelaysCountForSignedEvent>0?(_(),u("div",V,[e("div",T,[q,e("input",{readonly:"",value:(n=l(a).currentRelay)!=null&&n.url?`${(o=l(a).currentRelay)==null?void 0:o.url} (already selected)`:"Firstly connect to default relay",type:"text"},null,8,D)]),(_(!0),u(C,null,F(l(a).additionalRelaysCountForSignedEvent,f=>(_(),u("div",null,[e("div",H,[e("span",null,i(f+1)+".",1),e("input",{onInput:E=>S(E,f),placeholder:"[wss://]relay.example.com",type:"text"},null,40,L)])]))),256))])):j("",!0)])]),e("div",U,[Y,e("div",$,[e("textarea",{class:"signed-json-textarea",name:"signed_json",id:"signed_json",cols:"30",rows:"5",onInput:m,placeholder:'{"kind":1,"pubkey":"5486dbb083512982669fa180aa02d722ce35054233cea724061fbc5f39f81aa3","created_at":1685664152,"content":"Test message ðŸ‘‹","tags":[],"id":"89adae408121ba6d721203365becff4d312292a9dd9b7a35ffa230a1483b09a2","sig":"b2592ae88ba1040c928e458dd6822413f148c8cc4f478d992e024e8c9d9648b96e6ce6dc564ab5815675007f824d9e9f634f8dbde554afeb6e594bcaac4389dd"}'},i(l(c).signedJson),33)])]),e("div",z,[e("div",G,i(d.value)+" "+i(s.broadcastError),1),e("button",{class:"send-btn send-btn_signed-json",onClick:y},i(s.isSendingMessage?"Broadcasting...":"Broadcast"),1)])])}}});const W=N(K,[["__scopeId","data-v-2af0a718"]]);export{W as default};
