import{d as h,y as b,u as I,g as S,j as B,c as k,b as e,q as M,t as p,z as E,A as P,B as w,C as x,p as K,e as T,o as C,_ as V}from"../main.js";import{u as D}from"./PubKey-e93ab789.js";const F=n=>(K("data-v-d083a9cb"),n=n(),T(),n),N={class:"message-fields-wrapper"},R={class:"message-fields"},j={class:"message-fields__field"},q=F(()=>e("label",{for:"message"},[e("strong",null,"Message to broadcast")],-1)),z={class:"field-elements"},A=["value"],H={class:"send-btn-wrapper"},G={class:"error"},J=h({__name:"MessageInput",props:{sentEventIds:{},isSendingMessage:{type:Boolean}},emits:["broadcastEvent"],setup(n,{emit:g}){const _=n,m=g,d=b(),v=I(),i=D(),c=S(),a=B(""),y=async()=>{const s=d.nsec?d.nsec.trim():"";if(!s.length){a.value="Please provide your private key or generate random key.";return}const t=c.messageToBroadcast.trim();if(!t.length){a.value="Please provide message to broadcast.";return}let r;try{const{data:u}=E.decode(s);r=u,i.updateKeyFromPrivate(P(r))}catch{a.value="Invalid private key. Please check it and try again.";return}const l=v.currentRelay;if(!l||l.status!==1){a.value="Please connect to relay first.";return}const o={kind:1,pubkey:i.fromPrivate,created_at:Math.floor(Date.now()/1e3),content:t,tags:[],id:"",sig:""};if(o.id=w(o),o.sig=x(o,r),_.sentEventIds.has(o.id)){a.value="The same event can't be sent twice (same id, signature).";return}a.value="",m("broadcastEvent",o,"text")},f=s=>{var t;c.updateMessageToBroadcast((t=s==null?void 0:s.target)==null?void 0:t.value)};return(s,t)=>(C(),k("div",N,[e("div",R,[e("div",j,[q,e("div",z,[e("textarea",{class:"message-input",name:"message",id:"message",cols:"30",rows:"3",value:M(c).messageToBroadcast,onInput:f,placeholder:"Test message ðŸ‘‹"},null,40,A)]),e("div",H,[e("button",{class:"send-btn",onClick:y},p(s.isSendingMessage?"Broadcasting...":"Broadcast"),1)])])]),e("div",G,p(a.value),1)]))}});const Q=V(J,[["__scopeId","data-v-d083a9cb"]]);export{Q as default};
